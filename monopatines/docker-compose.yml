services:

#  admin_service:
#    build:
#      context: ./mvc_administracion
#      dockerfile: Dockerfile
#    ports:
#      - "8090:8090"


  # üßç‚Äç‚ôÇÔ∏è USER-SERVICE
  mvc_usuario:
    build: ./mvc_usuario
    container_name: mvc_usuario
    ports:
      - "8081:8081"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_usuario:3306/db_usuario
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_usuario

  db_usuario:
    image: mysql:latest
    container_name: db_usuario
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_usuario
    ports:
      - "3307:3306"
    volumes:
      - db_usuario_data:/var/lib/mysql

  # üõ¥ mvc_monopatin
  mvc_monopatin:
    build: ./mvc_monopatin
    container_name: mvc_monopatin
    ports:
      - "8082:8082"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_monopatin:3306/db_monopatin
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_monopatin

  db_monopatin:
    image: mysql:latest
    container_name: db_monopatin
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_monopatin
    ports:
      - "3308:3306"
    volumes:
      - db_monopatin_data:/var/lib/mysql

  # üó∫Ô∏è TRIP-SERVICE
  trip-service:
    build: ./trip_service
    container_name: trip_service
    ports:
      - "8083:8083"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_trips:3306/db_trips
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_trips

  db_trips:
    image: mysql:latest
    container_name: db_trips
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_trips
    ports:
      - "3309:3306"
    volumes:
      - db_trips_data:/var/lib/mysql
    
  #  mvc_administracion
  mvc_administracion:
    build: ./mvc_administracion
    container_name: mvc_administracion
    ports:
      - "8084:8084"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_administracion:3306/db_administracion
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_administracion

  db_administracion:
    image: mysql:latest
    container_name: db_administracion
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_administracion
    ports:
      - "3310:3306"
    volumes:
      - db_administracion_data:/var/lib/mysql
    
  #  mvc_facturacion
  mvc_facturacion:
    build: ./mvc_facturacion
    container_name: mvc_facturacion
    ports:
      - "8085:8085"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_facturacion:3306/db_facturacion
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_facturacion

  db_facturacion:
    image: mysql:latest
    container_name: db_facturacion
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_facturacion
    ports:
      - "3311:3306"
    volumes:
      - db_facturacion_data:/var/lib/mysql

  # üö™ API-GATEWAY
  api-gateway:
    build: ./api_gateway
    container_name: api_gateway
    ports:
      - "8080:8080"
    depends_on:
      - mvc_usuario
      - mvc_monopatin
      - trip-service
      - mvc_administracion
      - mvc_facturacion
volumes:
  db_usuario_data:
  db_monopatin_data:
  db_trips_data:
  db_administracion_data:
  db_facturacion_data:
