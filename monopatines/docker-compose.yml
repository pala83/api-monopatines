services:
  # üßç‚Äç‚ôÇÔ∏è USER-SERVICE
  mvc-usuario:
    build:
      context: ./mvc_usuario
      dockerfile: Dockerfile
    container_name: mvc_usuario
    ports:
      - "8082:8082"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_usuario:3306/db_usuario
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_usuario
    networks:
      - net_monopatines

  db_usuario:
    image: mysql:latest
    container_name: db_usuario
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_usuario
    ports:
      - "3307:3306"
    volumes:
      - db_usuario_data:/var/lib/mysql
    networks:
      - net_monopatines

  # mvc_monopatin
  mvc-monopatin:
    build:
      context: ./mvc_monopatin
      dockerfile: Dockerfile
    container_name: mvc_monopatin
    ports:
      - "8084:8084"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_monopatin:3306/db_monopatin
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_monopatin
    networks:
      - net_monopatines

  db_monopatin:
    image: mysql:latest
    container_name: db_monopatin
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_monopatin
    ports:
      - "3308:3306"
    volumes:
      - db_monopatin_data:/var/lib/mysql
    networks:
      - net_monopatines

#  MVC_VIAJE
  mvc-viaje:
    build:
      context: ./mvc_viaje
      dockerfile: Dockerfile
    container_name: mvc_viaje
    ports:
      - "8086:8086"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_viaje:3306/db_viaje
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_viaje
    networks:
      - net_monopatines

  db_viaje:
    image: mysql:latest
    container_name: db_viaje
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_viaje
    ports:
      - "3309:3306"
    volumes:
      - db_viaje_data:/var/lib/mysql
    networks:
      - net_monopatines

  #  mvc_facturacion
  mvc-facturacion:
    build:
      context: ./mvc_facturacion
      dockerfile: Dockerfile
    container_name: mvc_facturacion
    ports:
      - "8088:8088"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_facturacion:3306/db_facturacion
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_facturacion
    networks:
      - net_monopatines

  db_facturacion:
    image: mysql:latest
    container_name: db_facturacion
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_facturacion
    ports:
      - "3310:3306"
    volumes:
      - db_facturacion_data:/var/lib/mysql
    networks:
      - net_monopatines


  #  mvc_administracion
  mvc-mantenimiento:
    build:
      context: ./mvc_mantenimiento
      dockerfile: Dockerfile
    container_name: mvc_mantenimiento
    ports:
      - "8090:8090"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://db_mantenimiento:3306/db_mantenimiento
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=1234
    depends_on:
      - db_mantenimiento
    networks:
      - net_monopatines

  db_mantenimiento:
    image: mysql:latest
    container_name: db_mantenimiento
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: db_mantenimiento
    ports:
      - "3311:3306"
    volumes:
      - db_mantenimiento_data:/var/lib/mysql
    networks:
      - net_monopatines

  # üö™ API-GATEWAY
  api_gateway:
    build:
      context: ./api_gateway
      dockerfile: Dockerfile
    container_name: api_gateway
    ports:
      - "8080:8080"
    depends_on:
       - mvc-usuario
       - mvc-monopatin
       - mvc-viaje
       - mvc-facturacion
     # - mvc_mantenimiento
    networks:
      - net_monopatines
volumes:
  db_usuario_data:
  db_monopatin_data:
  db_viaje_data:
  db_facturacion_data:
  db_mantenimiento_data:
#  mongo_data:

networks:
  net_monopatines:
    driver: bridge